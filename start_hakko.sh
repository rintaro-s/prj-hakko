#!/bin/bash

echo "­Ъџђ HAKKO AI Transporter сѓњУхитІЋсЂЌсЂЙсЂЎ..."

# --- WindowsС╗«ТЃ│сЃъсѓисЃ│сѓњсЃљсЃЃсѓ»сѓ░сЃЕсѓдсЃ│сЃЅсЂДУхитІЋ ---
echo "­ЪќЦ№ИЈ WindowsсѓњсЃљсЃЃсѓ»сѓ░сЃЕсѓдсЃ│сЃЅсЂДУхитІЋСИГ..."
# --no-provision сѓњсЂцсЂЉсѓІсЂЊсЂесЂДсђЂтѕЮтЏъсѓ╗сЃЃсЃѕсѓбсЃЃсЃЌсЂ«тЄдуљєсѓњсѓ╣сѓГсЃЃсЃЌсЂЎсѓІ
vagrant up --no-provision

if [ $? -ne 0 ]; then
    echo "РЮї WindowsсЂ«УхитІЋсЂФтц▒ТЋЌсЂЌсЂЙсЂЌсЂЪсђѓ"
    exit 1
fi

# --- DockerсЂДтЈЌС┐АтЂ┤сѓбсЃЌсЃфсѓњУхитІЋ ---
echo "­ЪЏ░№ИЈ тЈЌС┐Асѓ»сЃЕсѓцсѓбсЃ│сЃѕсѓњУхитІЋСИГ..."

# XсѓхсЃ╝сЃљсЃ╝сЂИсЂ«сѓбсѓ»сѓ╗сѓ╣сѓњУе▒тЈ»
xhost +local:docker

# Dockerсѓ│сЃ│сЃєсЃісѓњУхитІЋ
docker run --rm -it \
    --net=host \
    -e DISPLAY=$DISPLAY \
    -v /tmp/.X11-unix:/tmp/.X11-unix \
    hakko-receiver

if [ $? -ne 0 ]; then
    echo "РЮї тЈЌС┐Асѓ»сЃЕсѓцсѓбсЃ│сЃѕсЂ«УхитІЋсЂФтц▒ТЋЌсЂЌсЂЙсЂЌсЂЪсђѓ"
    # сѓесЃЕсЃ╝сЂїуЎ║ућЪсЂЌсЂЪта┤тљѕсѓѓVMсѓњтЂюТГбсЂЎсѓІ
    echo "VMсѓњсѓисЃБсЃЃсЃѕсЃђсѓдсЃ│сЂЌсЂЙсЂЎ..."
    vagrant halt
    exit 1
fi

echo "­ЪЉІ сѓбсЃЌсЃфсЂїухѓС║єсЂЌсЂЙсЂЌсЂЪсђѓWindowsсѓњсѓисЃБсЃЃсЃѕсЃђсѓдсЃ│сЂЌсЂЙсЂЎ..."
vagrant halt

echo "РюЁ сЂЎсЂ╣сЂдсЂ«сЃЌсЃГсѓ╗сѓ╣сЂїт«їС║єсЂЌсЂЙсЂЌсЂЪ№╝Ђ"
